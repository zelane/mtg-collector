var re=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var ee=($,f,b)=>f in $?re($,f,{enumerable:!0,configurable:!0,writable:!0,value:b}):$[f]=b,te=($,f)=>{for(var b in f||(f={}))ie.call(f,b)&&ee($,b,f[b]);if(Z)for(var b of Z(f))ce.call(f,b)&&ee($,b,f[b]);return $};import{r as B,w as ue,o as w,c as k,a as o,t as S,u as e,n as j,F as O,b as I,d as M,v as z,e as W,f as E,g as R,P as de,k as L,h as P,i as pe,j as K,l as q,m as ne,p as le,q as ae,s as D,x as Q,D as me,y as fe,z as J,A as oe,B as _e,C as he}from"./vendor.909db62e.js";const ye=function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))g(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const U of a.addedNodes)U.tagName==="LINK"&&U.rel==="modulepreload"&&g(U)}).observe(document,{childList:!0,subtree:!0});function b(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function g(t){if(t.ep)return;t.ep=!0;const a=b(t);fetch(t.href,a)}};ye();const ve={class:"filter-group colours"},ge={class:"header"},be=["data-colour"],Ce=["value","id"],we=["for"],$e={props:{modelValue:{type:Object,default:()=>({colours:[],or:!1})}},emits:["update:modelValue"],setup($,{emit:f}){const b={Red:"R",Green:"G",Black:"B",Blue:"U",White:"W",Colourless:"C"},g=B({colours:[],or:!1}),t={Azorius:["U","W"],Boros:["R","W"],Dimir:["B","U"],Golgari:["B","G"],Gruul:["G","R"],Izzet:["R","U"],Orzhov:["B","W"],Rakdos:["B","R"],Selesnya:["G","W"],Simic:["G","U"]},a={Abzan:["B","G","W"],Bant:["G","U","W"],Esper:["B","U","W"],Grixis:["B","R","U"],Jeskai:["R","U","W"],Jund:["B","G","R"],Mardu:["B","R","W"],Naya:["G","R","W"],Sultai:["B","G","U"],Temur:["G","R","U"]},U={Glint:"W",Dune:"U",Ink:"B",Witch:"R",Yore:"G"};ue(()=>{f("update:modelValue",g)});const G=T=>{let v=[...T].sort();if(T.length===2){for(const[u,l]of Object.entries(t))if(v.every((r,_)=>r===l[_]))return u}else if(T.length===3){for(const[u,l]of Object.entries(a))if(v.every((r,_)=>r===l[_]))return u}else if(T.length===4){for(const[u,l]of Object.entries(U))if(!T.includes(l))return u}};return(T,v)=>(w(),k("div",ve,[o("div",ge,[o("h3",null,"Colours "+S(e(g).colours.length>1?`(${G(e(g).colours)})`:""),1),o("div",{class:j(["bi-toggle",{active:e(g).or}]),onClick:v[0]||(v[0]=u=>e(g).or=!e(g).or)},S(e(g).or?"And":"Or"),3)]),(w(),k(O,null,I(b,u=>o("div",{class:j(["input-group colour",e(g).colours.includes(u)?"selected":""]),"data-colour":u,key:u},[M(o("input",{type:"checkbox","onUpdate:modelValue":v[1]||(v[1]=l=>e(g).colours=l),value:u,id:u},null,8,Ce),[[z,e(g).colours]]),o("label",{for:u,class:j("icon icon-"+u)},null,10,we)],10,be)),64))]))}};const ke={class:"filter-group rarities"},xe=o("h3",null,"Rarity",-1),Se=["data-rarity"],Ve=["onUpdate:modelValue","value","id"],Ue=["for","title"],Te={class:"filter-group"},Me=o("h3",null,"Name",-1),Pe={class:"filter-group mana"},Ge=o("h3",null,"Mana Cost",-1),Ne={class:"filter-group price"},Ee=o("h3",null,"Avg Price",-1),Be={class:"filter-group"},Oe=o("h3",null,"Types",-1),Ae={class:"filter-group"},Fe=o("h3",null,"Keywords",-1),Re={class:"filter-group"},Ie=o("h3",null,"Card text",-1),Le={class:"filter-group"},je=o("h3",null,"Set",-1),De={key:0,class:"filter-group compare"},ze=o("h3",null,"Compare",-1),We={class:"grid"},qe=["id","onUpdate:modelValue"],Ke=["for"],Je=["id","onUpdate:modelValue"],Qe=["for"],Ye={props:{cards:{type:Array,default:()=>[]},collections:{type:Array,default:()=>[]},sort:{type:String,default:"Price"},db:{type:Object,default:()=>{}}},emits:["change","loading"],setup($,{emit:f}){const b=$;let g=B({keywords:[],sets:[],tribes:[],allSets:[]}),t=B({colours:{colours:[],or:!1},rarity:[],keywords:[],tribes:[],name:"",cardText:"",sets:[],mana:{value:[0,20],min:0,max:20},price:{value:[0,null],min:0,max:100},dupesOnly:!1,sort:"Price",incCol:{},excCol:{},ors:{}});const a=["special","mythic","rare","uncommon","common"],U=async(u,l)=>{const r=new Request(l);let _=await u.match(r);return _||(await u.add(r),_=await u.match(r)),await _.json()};caches.open("cardDataCache").then(async u=>{let l=await U(u,"https://api.scryfall.com/catalog/creature-types");g.tribes=l.data,g.tribes=g.tribes.concat(["Enchantment","Sorcery","Land","Creature","Instant","Artifact"]);let r=await U(u,"https://api.scryfall.com/sets");g.allSets=r.data});const G=(u,l)=>{if(t.sort==="Price")return u.price?u.price<l.price?1:-1:!0;if(t.sort==="Mana")return parseFloat(u.cmc)<parseFloat(l.cmc)?1:-1;if(t.sort==="Count")return parseFloat(u.count)<parseFloat(l.count)?1:-1},T=async(u,l)=>new Promise(async r=>{let _=setTimeout(()=>f("loading"),300),i=u.sort(G);if(l.cardText&&l.cardText!==""){const c=new pe(i,{ignoreLocation:!0,threshold:.5,findAllMatches:!0,keys:["oracle_text","card_faces.oracle_text"]});i=[],c.search(l.cardText).forEach(m=>{i.push(m.item)})}for(const c of Object.keys(l.incCol)){if(!l.incCol[c])continue;const V=(await b.db.collections.get({name:c})).cards.map(x=>x.oracle_id);i=i.filter(x=>V.includes(x.oracle_id))}for(const c of Object.keys(l.excCol)){if(!l.excCol[c])continue;const V=(await b.db.collections.get({name:c})).cards.map(x=>x.oracle_id);i=i.filter(x=>!V.includes(x.oracle_id))}let d=0,h=0;i=i.filter(c=>{if(l.dupesOnly&&c.count===1||!(!l.name||!l.name!=""||c.name.toLowerCase().includes(l.name.toLowerCase())))return!1;const V=y=>l.colours.or?l.colours.colours.every(y):l.colours.colours.some(y);if(l.colours.colours.length>0&&!V(C=>C==="C"?c.color_identity.length===0:(c.color_identity||[]).includes(C))||!l.keywords.every(y=>(c.keywords||[]).includes(y)))return!1;const F=l.tribes.some(y=>(c.type_line.toLowerCase()||"").includes(y.toLowerCase()));if(l.tribes.length>0&&!F||!(l.rarity.length>0?[...l.rarity].includes(c.rarity):!0))return!1;let p=!0;return l.sets.length>0&&(p=l.sets.some(y=>c.set===y)),!p||!(c.cmc>=l.mana.value[0]&&c.cmc<=l.mana.value[1])||!(c.price>=(l.price.value[0]||0)&&c.price<=(l.price.value[1]||9999))?!1:(h+=c.price,!0)}),h=parseInt(h),d=i.length,clearTimeout(_),r([i,d,h])});W(()=>b.cards,async(u,l)=>{const r=new Set,_=[];let i=.9;u.forEach(m=>{m.price=parseFloat(m.prices.eur||parseFloat(m.prices.usd)*i||0),m.keywords.forEach(V=>{r.add(V)}),_[m.set]=m.set_name}),g.keywords=[...r],g.sets=Object.keys(_).map(m=>({set:m,setName:_[m]}));let[d,h,c]=await T(u,t);f("change",d,h,c)}),W(()=>b.sort,(u,l)=>{t.sort=u});let v=null;return W(t,async()=>{clearTimeout(v),v=setTimeout(async()=>{let[u,l,r]=await T(b.cards,t);f("change",u,l,r)},500)}),(u,l)=>(w(),k("div",null,[E($e,{modelValue:e(t).colours,"onUpdate:modelValue":l[0]||(l[0]=r=>e(t).colours=r)},null,8,["modelValue"]),o("div",ke,[xe,(w(),k(O,null,I(a,r=>o("div",{class:"input-group rarity","data-rarity":r,key:r},[M(o("input",{type:"checkbox","onUpdate:modelValue":_=>e(t).rarity=_,value:r,id:r},null,8,Ve),[[z,e(t).rarity]]),o("label",{for:r,title:r},null,8,Ue)],8,Se)),64))]),o("div",Te,[Me,M(o("input",{type:"search","onUpdate:modelValue":l[1]||(l[1]=r=>e(t).name=r)},null,512),[[R,e(t).name]])]),o("div",Pe,[Ge,E(e(de),{modelValue:e(t).mana.value,"onUpdate:modelValue":l[2]||(l[2]=r=>e(t).mana.value=r),min:e(t).mana.min,max:e(t).mana.max},null,8,["modelValue","min","max"])]),o("div",Ne,[Ee,M(o("input",{type:"number","onUpdate:modelValue":l[3]||(l[3]=r=>e(t).price.value[0]=r),placeholder:"Min"},null,512),[[R,e(t).price.value[0]]]),M(o("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=r=>e(t).price.value[1]=r),placeholder:"Max"},null,512),[[R,e(t).price.value[1]]])]),o("div",Be,[Oe,E(e(L),{modelValue:e(t).tribes,"onUpdate:modelValue":l[5]||(l[5]=r=>e(t).tribes=r),options:e(g).tribes,searchable:!0,mode:"tags","create-option":!0},null,8,["modelValue","options"])]),o("div",Ae,[Fe,E(e(L),{modelValue:e(t).keywords,"onUpdate:modelValue":l[6]||(l[6]=r=>e(t).keywords=r),options:e(g).keywords,searchable:!0,mode:"tags"},null,8,["modelValue","options"])]),o("div",Re,[Ie,M(o("input",{type:"search","onUpdate:modelValue":l[7]||(l[7]=r=>e(t).cardText=r)},null,512),[[R,e(t).cardText]])]),o("div",Le,[je,E(e(L),{modelValue:e(t).sets,"onUpdate:modelValue":l[8]||(l[8]=r=>e(t).sets=r),options:e(g).sets,label:"setName","value-prop":"set",searchable:!0,mode:"tags"},null,8,["modelValue","options"])]),$.collections.length>0?(w(),k("div",De,[ze,o("div",We,[(w(!0),k(O,null,I($.collections,r=>(w(),k(O,{key:r},[o("div",null,S(r),1),o("div",null,[M(o("input",{type:"checkbox",id:r+"-inc","onUpdate:modelValue":_=>e(t).incCol[r]=_,value:!1},null,8,qe),[[z,e(t).incCol[r]]]),o("label",{class:"inc",for:r+"-inc"},null,8,Ke)]),o("div",null,[M(o("input",{type:"checkbox",id:r+"-exc","onUpdate:modelValue":_=>e(t).excCol[r]=_,value:!1},null,8,Je),[[z,e(t).excCol[r]]]),o("label",{class:"exc",for:r+"-exc"},null,8,Qe)])],64))),128))])])):P("",!0)]))}};var Y=($,f)=>{const b=$.__vccOpts||$;for(const[g,t]of f)b[g]=t;return b};const H=$=>(le("data-v-4ef910ec"),$=$(),ae(),$),He={class:"upload"},Xe=H(()=>o("span",null,"+",-1)),Ze=[Xe],et={class:"form"},tt=H(()=>o("h3",null,"Name",-1)),ot=H(()=>o("h3",null,"Format",-1)),st={key:1,class:"button",for:"file-input"},nt=["disabled"],lt={key:3,class:"buttons"},at={key:4,class:"progress"},rt={props:{db:Object,collections:Array,setIds:Set},emits:["change","close"],setup($,{emit:f}){const b=$,g="https://api.scryfall.com/cards/collection",t=B({name:null,file:null,text:null,encoding:null,format:null,active:!1,progress:0,count:0,total:0}),a=async(_="",i={})=>(await fetch(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json(),U=async _=>{let i=await _.arrayBuffer(),d=new Uint8Array(i.slice(0,10));return d[0].toString(16)=="ff"&&d[1].toString(16)=="fe"?"UTF-16LE":d[0].toString(16)=="fe"&&d[1].toString(16)=="ff"?"UTF-16BE":d[1]==0&&d[3]==0&&d[5]==0?"UTF-16LE":"UTF-8"},G=async _=>{t.active=!0,t.progress=0;let i={};if(t.format==="MTGA"){const d=/([0-9]+) (.+) \((.+)\) ([0-9]+)/g,h=t.text.matchAll(d);for(const c of h)i[c[3]+c[4]]={name:c[2].split(" // ")[0],count:parseInt(c[1]),set:c[3],number:c[4]}}else if(t.format==="MTGO"){const d=/([0-9]+) (.+)/g,h=t.text.matchAll(d);for(const c of h)i[c[2]]={name:c[2].split(" // ")[0],count:parseInt(c[1]),set:"",number:""}}r(t.name,i)},T=async _=>{if(v.value.files.length===0)return;let i=v.value.files[0];const d=new FileReader;t.active=!0,t.progress=0;let h=null;t.format==="DragonShield Web"&&(h=u),d.onload=async()=>{let m=await h(d.result);r(t.name,m)};let c=await U(i);d.readAsText(i,c)},v=K(null);q.parsePromise=_=>new Promise((i,d)=>{q.parse(_,{header:!0,worker:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:i,error:d})});const u=async _=>{_=_.replace('"sep=,"',"");let i=await q.parsePromise(_),d={};return i.data.forEach(h=>{const c=h["Set Name"];let m=h["Set Code"].toLowerCase();b.setIds.has(m)?d[m+h["Card Number"]]={name:h["Card Name"],count:parseInt(h.Quantity),set:m,number:h["Card Number"].toString()}:(console.log(`Couldn't find set for ${h["Card Name"]} ${h["Card Number"]} ${c} [${m}]`),d[m+h["Card Number"]]={name:h["Card Name"],count:parseInt(h.Quantity),set:"",number:""})}),d},l=async _=>{const i=[],d={};try{let h=[];for(const[c,m]of Object.entries(_)){let V={};m.set===""&&m.number===""?(V.name=m.name,d[m.name]=m.count):(V.set=m.set,V.collector_number=m.number,d[m.set+m.number]=m.count),i.push(V)}t.total=i.length;for(let c=0;c<i.length;c+=75){const m=await a(g,{identifiers:i.slice(c,c+75)});m.not_found.length>0&&console.log(m.not_found);let V=m.data.map(x=>(x.count=d[x.name]||d[x.set+x.collector_number],x));h=h.concat(V),t.count=c,t.progress=c/i.length*100,await new Promise(x=>setTimeout(x,100))}return t.progress=100,h}catch(h){console.error(h)}finally{t.active=!1,t.count=0,t.progress=0,t.total=0,f("close")}},r=async(_,i,d=!0)=>{let h=[];if(d&&b.collections.includes(_)){const c=await b.db.collections.get({name:_});h=c.cards;for(const[m,V]of Object.entries(i)){let x=c.cards.filter(F=>V.set!==""&&V.set===F.set&&V.number===F.collector_number?!0:F.name===V.name);x.length>0&&(x[0].count=V.count,delete i[m])}}if(i){const c=await l(i);h=h.concat(c)}f("change",_,h)};return(_,i)=>(w(),k("div",He,[o("button",{class:"small close",onClick:i[0]||(i[0]=d=>f("close"))},Ze),o("div",et,[tt,M(o("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=d=>e(t).name=d)},null,512),[[R,e(t).name]]),ot,E(e(L),{modelValue:e(t).format,"onUpdate:modelValue":i[2]||(i[2]=d=>e(t).format=d),options:["DragonShield Web","DragonShield Mobile","MTGA","MTGO"],"can-clear":!1},null,8,["modelValue"]),["MTGA","MTGO"].includes(e(t).format)?M((w(),k("textarea",{key:0,"onUpdate:modelValue":i[3]||(i[3]=d=>e(t).text=d)},null,512)),[[R,e(t).text]]):P("",!0),["DragonShield Web","DragonShield Mobile"].includes(e(t).format)?(w(),k("label",st,"Choose file")):P("",!0),e(t).format==="DragonShield Web"?(w(),k("input",{key:2,id:"file-input",ref_key:"fileElem",ref:v,type:"file",disabled:e(t).active},null,8,nt)):P("",!0),!e(t).active&&e(t).format&&(e(t).text||v.value)?(w(),k("div",lt,[o("button",{onClick:i[4]||(i[4]=d=>["MTGA","MTGO"].includes(e(t).format)?G():T())}," Upload ")])):P("",!0),e(t).active?(w(),k("div",at,[o("span",null,"Processing cards: "+S(e(t).count)+" / "+S(e(t).total),1),o("div",{class:"bar",style:ne({width:e(t).progress+"%"})},null,4)])):P("",!0)])]))}};var it=Y(rt,[["__scopeId","data-v-4ef910ec"]]);const ct={key:0,class:"loader"},ut={class:"img"},dt=["src"],pt=["src"],mt=["src"],ft={class:"buttons"},_t=["onClick"],ht=["onClick"],yt={class:"name"},vt={class:"set"},gt={props:{cards:Array,zoom:Number,loading:Boolean},emits:["clip","viewPrints"],setup($,{emit:f}){const b=$;return(g,t)=>(w(),k(O,null,[b.loading?(w(),k("div",ct," Loading ")):P("",!0),o("div",{class:"cards",style:ne({"font-size":18+b.zoom*2+"px"})},[(w(!0),k(O,null,I(b.cards.slice(0,500),a=>(w(),k("div",{class:"card",key:a.id},[o("div",ut,[a.image_uris?(w(),k("img",{key:0,src:a.image_uris.normal},null,8,dt)):P("",!0),a.card_faces&&a.card_faces[0].image_uris?(w(),k("img",{key:1,class:"flip front",src:a.card_faces[0].image_uris.normal},null,8,pt)):P("",!0),a.card_faces&&a.card_faces[0].image_uris?(w(),k("img",{key:2,class:"flip back",src:a.card_faces[1].image_uris.normal},null,8,mt)):P("",!0),o("div",ft,[o("button",{class:"small prints icon icon-library_books",onClick:D(U=>{f("viewPrints",a.name)},["stop"]),title:"View all prints"},null,8,_t),o("button",{class:"small clip icon icon-add",onClick:D(U=>f("clip",a),["stop"]),title:"Add to clipboard"},null,8,ht)])]),o("p",yt,S(a.count)+" "+S(a.name),1),o("p",null,S(a.set_name),1),o("p",null,[Q(S(new Intl.NumberFormat("en-GB",{style:"currency",currency:"EUR"}).format(a.price))+" ",1),o("span",vt,S(a.set)+":"+S(a.collector_number),1)])]))),128))],4)],64))}};var se=Y(gt,[["__scopeId","data-v-1ad7dd60"]]);const A=$=>(le("data-v-746eb29a"),$=$(),ae(),$),bt={id:"window"},Ct={id:"sidebar"},wt={class:"filter-group collections"},$t=A(()=>o("h3",null,"View Collection",-1)),kt={class:"filter-group"},xt=A(()=>o("h3",null,"View Set",-1)),St={class:"filter-group"},Vt=A(()=>o("h3",null,[Q(" Scryfall Search "),o("a",{href:"https://scryfall.com/docs/syntax",target:"_blank"},"?")],-1)),Ut=A(()=>o("hr",null,null,-1)),Tt={class:"info-bar"},Mt=A(()=>o("span",{class:"icon icon-content_paste"},null,-1)),Pt={class:"info"},Gt={class:"sort"},Nt={class:"zoom"},Et=A(()=>o("span",{class:"icon icon-content_paste"},null,-1)),Bt={class:"prints"},Ot=A(()=>o("h3",null,"Prints",-1)),At={key:0,class:"info"},Ft=A(()=>o("h3",null,"Selection info",-1)),Rt={class:"sets"},It=["onClick"],Lt={class:"clipboard"},jt={class:"clip-cards"},Dt={class:"buttons"},zt={class:"menu-button"},Wt={class:"menu-button"},qt=["onClick"],Kt={setup($){const f=new me("mtg");f.version(2).stores({collections:"&name"});const b=B({allSets:[]}),g=B({count:0,total_value:0,zoom:0}),t=B({cards:[]}),a=B({upload:!1,clipboard:!1,prints:!1,sidebarShow:!1,sidebar:"clipboard",menu:!1,random:{},selector:"collection"}),U=new Map;let G=K(!1),T=K(!1);const v=B({collections:[],all:[],filtered:[],sort:"Price",prints:[]});let u=B({value:[]});const l=async(p,n)=>{const s=new Request(n);let y=await p.match(s);return y||(await p.add(s),y=await p.match(s)),await y.json()},r=async p=>{if(p===[])return;let n=new Map;for(const s of p){let y=await f.collections.get({name:s});for(const C of y.cards)if(n.has(C.id)){let N=n.get(C.id);N.count=parseInt(N.count)+parseInt(C.count),n.set(C.id,N)}else n.set(C.id,C)}v.all=[...n.values()]},_=async p=>{i("e:"+p)},i=async(p,n="prints")=>{let s="https://api.scryfall.com/cards/search?"+new URLSearchParams({q:`${p} -border:silver -is:digital`,unique:n}),y=[];G.value=!0;try{for(;;){let C=await l(m,s);if(y=y.concat(C.data),!C.has_more)break;s=C.next_page,await new Promise(N=>setTimeout(N,100))}v.all=y}finally{G.value=!1}},d=async(p,n="prints")=>{let s="https://api.scryfall.com/cards/search?"+new URLSearchParams({q:`!"${p}" -border:silver -is:digital`,unique:n}),y=[];a.sidebar="prints",a.sidebarShow=!0,T.value=!0;try{for(;;){let C=await l(m,s);if(y=y.concat(C.data),!C.has_more)break;s=C.next_page,await new Promise(N=>setTimeout(N,100))}y.forEach(C=>{C.price=parseFloat(C.prices.eur||parseFloat(C.prices.usd)*.9||0)}),v.prints=y.sort((C,N)=>C.price<N.price?1:-1)}finally{T.value=!1}},h=async p=>{if(confirm(`Are you sure you want to delete ${p.join(", ")}?`))p.map(async n=>{await f.collections.delete(n),v.collections.pop(n),u.value.pop(n)});else return};W(u,p=>r(p.value));const c=async(p,n,s)=>{g.count=n,g.total_value=s,v.filtered=p,G.value=!1};f.collections.toCollection().primaryKeys().then(p=>{p.length!==0&&(v.collections=p.sort(),u.value=[p[0]])});let m=null;caches.open("cardDataCache").then(async p=>{m=p;let n=await l(p,"https://api.scryfall.com/sets");n.data.forEach(s=>U.set(s.name,s.code)),b.allSets=n.data});const V=async(p,n)=>{await f.collections.put({name:p,cards:n}),v.collections.includes(p)||v.collections.push(p),u.value=[p]},x=async p=>{let n="";p==="mtgo"?t.cards.forEach(s=>{n+=`${s.count||1} ${s.name} 
`}):p==="mkm"?t.cards.forEach(s=>{n+=`${s.count||1} ${s.name} (${s.set_name})
`}):p==="moxfield"&&(n=`"Count","Tradelist Count","Name","Edition","Condition","Language","Foil","Tags","Last Modified","Collector Number"
`,t.cards.forEach(s=>{n+=`"${s.count||1}","0","${s.name}","${s.set}","Near Mint","English","","","2022-03-22 02:52:33.210000","${s.collector_number}"
`})),navigator.clipboard.writeText(n)},F=async(p,n)=>{let s=await f.collections.get({name:p});for(const y of n){let C=s.cards.filter(N=>N.id===y.id);C.length===0?s.cards.push(te({},_e.deepUnref(y))):C[0].count+=y.count}await f.collections.put(s),u.value.includes(p)&&(v.all=v.all.concat(newCard))},X=p=>{const n=p.reduce((s,y)=>{const C=s.get(y.set_name);return s.set(y.set_name,C?C+1:1),s},new Map);return new Map([...n.entries()].sort((s,y)=>s[1]>y[1]?-1:1))};return(p,n)=>(w(),k("div",bt,[o("div",Ct,[o("div",wt,[$t,E(e(L),{modelValue:e(u).value,"onUpdate:modelValue":n[0]||(n[0]=s=>e(u).value=s),options:e(v).collections,mode:"tags",searchable:!0},null,8,["modelValue","options"]),o("button",{class:"small add",onClick:n[1]||(n[1]=s=>e(a).upload=!0)}," + "),o("button",{class:"small remove",onClick:n[2]||(n[2]=s=>h(e(u).value))}," - ")]),o("div",kt,[xt,E(e(L),{options:e(b).allSets,label:"name","value-prop":"code",searchable:!0,mode:"single",onSelect:_,onLoading:n[3]||(n[3]=s=>e(G).value=!0)},null,8,["options"])]),o("div",St,[Vt,o("input",{type:"search",onKeyup:n[4]||(n[4]=fe(s=>i(s.currentTarget.value,"cards"),["enter"]))},null,32)]),Ut,E(Ye,{onChange:c,cards:e(v).all,collections:e(v).collections,db:e(f),sort:e(v).sort},null,8,["cards","collections","db","sort"])]),o("div",{id:"main",onClick:n[21]||(n[21]=s=>e(a).sidebarShow=!1)},[e(a).upload?(w(),J(it,{key:0,onChange:V,onClose:n[5]||(n[5]=s=>e(a).upload=!1),db:e(f),collections:e(v).collections,"set-ids":new Set(e(U).values())},null,8,["db","collections","set-ids"])):P("",!0),o("div",Tt,[o("span",null,"Count: "+S(e(g).count),1),o("span",null,"Value: "+S(new Intl.NumberFormat("en-GB",{style:"currency",currency:"EUR"}).format(e(g).total_value)),1),o("span",{class:"clip",onClick:n[6]||(n[6]=D(()=>{e(a).sidebar="clipboard",e(a).sidebarShow=!e(a).sidebarShow},["stop"]))},[Mt,o("span",null,S(e(t).cards.length),1)]),o("span",Pt,[o("a",{href:"#",onClick:n[7]||(n[7]=D(s=>{e(a).sidebar="info",e(a).sidebarShow=!e(a).sidebarShow},["stop"]))},"Sets")]),o("span",Gt,[E(e(L),{modelValue:e(v).sort,"onUpdate:modelValue":n[8]||(n[8]=s=>e(v).sort=s),options:["Mana","Price","Count"],mode:"single","can-clear":!1},null,8,["modelValue"])]),o("span",Nt,[M(o("input",{type:"number","onUpdate:modelValue":n[9]||(n[9]=s=>e(g).zoom=s)},null,512),[[R,e(g).zoom]])])]),o("div",{class:j(["sidepanel",{show:e(a).sidebarShow}])},[o("div",{class:"menu",onClick:n[10]||(n[10]=D(s=>e(a).sidebarShow=!e(a).sidebarShow,["stop"]))},[Et,o("span",null,S(e(t).cards.length),1)]),M(o("div",Bt,[Ot,E(se,{cards:e(v).prints,loading:e(T),zoom:1,onClip:n[11]||(n[11]=s=>e(t).cards.push(s))},null,8,["cards","loading"])],512),[[oe,e(a).sidebar==="prints"]]),e(a).sidebar==="info"?(w(),k("div",At,[Ft,o("div",Rt,[(w(!0),k(O,null,I(X(e(v).filtered).entries(),([s,y])=>(w(),k("div",{key:s},[Q(S(y)+" ",1),o("a",{href:"#",onClick:C=>e(U).get(s)},S(s)+" "+S(e(U).get(s)),9,It)]))),128))])])):P("",!0),M(o("div",Lt,[o("h3",null,"Clipboard "+S(new Intl.NumberFormat("en-GB",{style:"currency",currency:"EUR"}).format(e(t).cards.reduce((s,y)=>s+=y.price,0))),1),o("div",jt,[(w(!0),k(O,null,I(e(t).cards,s=>(w(),k("div",{class:"clip-card",key:"clip-"+s.name},[o("p",null,S(s.count)+"x "+S(s.name)+" ("+S(s.set)+")",1)]))),128))]),o("div",Dt,[o("div",zt,[o("button",{onClick:n[12]||(n[12]=s=>e(a).random.clipExports=!e(a).random.clipExports)}," Export "),o("div",{class:j(["v-menu",{show:e(a).random.clipExports}])},[o("button",{onClick:n[13]||(n[13]=s=>x("mtgo"))}," MTGO "),o("button",{onClick:n[14]||(n[14]=s=>x("mkm"))}," MKM + Set "),o("button",{onClick:n[15]||(n[15]=s=>x("moxfield"))}," Mox ")],2)]),o("div",Wt,[o("button",{onClick:n[16]||(n[16]=s=>e(a).random.addToSet=!e(a).random.addToSet)}," Add to set "),o("div",{class:j(["v-menu",{show:e(a).random.addToSet}])},[(w(!0),k(O,null,I(e(u).value,s=>(w(),k("button",{onClick:y=>F(s,e(t).cards),key:s},S(s),9,qt))),128))],2)]),o("button",{onClick:n[17]||(n[17]=s=>e(t).cards=e(t).cards.concat(e(v).filtered))}," Clip All "),o("button",{onClick:n[18]||(n[18]=s=>e(t).cards=[])}," Clear ")])],512),[[oe,e(a).sidebar==="clipboard"]])],2),e(a).upload===!1?(w(),J(se,{key:1,cards:e(v).filtered,zoom:e(g).zoom,loading:e(G),onClip:n[19]||(n[19]=s=>e(t).cards.push(s)),onViewPrints:n[20]||(n[20]=s=>d(s))},null,8,["cards","zoom","loading"])):P("",!0)])]))}};var Jt=Y(Kt,[["__scopeId","data-v-746eb29a"]]);const Qt={setup($){return(f,b)=>(w(),J(Jt))}},Yt=he(Qt);Yt.mount("#app");
